//including all the library's
#include <Arduino.h>
#include <Servo.h>
#include "thingProperties.h"
//the pins of the four solar panels
#define solarPanelUR A0;
#define solarPanelDR A1;
#define solarPanelUL A2;
#define solarPanelDL A3;


// Setup code, will run only once
void setup() {

  // start Serial monitor and wait for it to finish[delay is to give the serial monitor time to start]
  Serial.begin(9600);
   delay(1500);
  
  initProperties();
  // Connect to Arduino IoT Cloud
  ArduinoCloud.begin(ArduinoIoTPreferredConnection);
   setDebugMessageLevel(2);
  ArduinoCloud.printDebugInfo();

  // connect the servo motors
  ServoRight.attach(8);
  ServoLeft.attach(9);
  //setting servos to default positions
  ServoRight.write(90);
  ServoLeft.write(90);

  // define some key variables
  int solarDataUR = 0;
  int solarDataDR = 0;
  int solarDataUL = 0;
  int solarDataDL = 0;
  int louversRotation = 0;
}
// all of the functions below [except the loop function] are for the loop function to call
// these need to be defined above the loop function itself as to avoid errors
void solarData(){
  /*
   all of these will be a value from 0-1023, with 0 being no volatge at pin and 1023 being max [5V]
   prefferably we will not reach anything over 1023, or something close to it
   as anything above 1023 could burn the arduino
  */
  solarDataUR=analogRead(solarPanelUR);
  solarDataDR=analogRead(solarPanelDR);
  solarDataUL=analogRead(solarPanelUL);
  solarDataDL=analogRead(solarPanelDL);
}

void adjustLouvers(){
  //rotating the servos[assuming they point towards the same direction]
  ServoRight.write(rotationlevel);
  ServoLeft.write(rotationlevel);
}

void calculations(){
  //Piotr plz help
}

void onmanualControlChange()  { // generated by arduino cloud
  // Add your code here to act upon ManualControl change
  // Think it will just update the variable itself if I give it the same name
}

void onmanualShadesChange()  {  // generated by arduino cloud
  // Add your code here to act upon Manualshades change
  louversRotation=manualShades;
}

void loop() {
  // check if anything happened in app
  ArduinoCloud.update();

  if(manualControl = true){
    //manual code
    adjustLouvers();
  }
  else{
    //automatic code
    solarData();
    //calculations
    calculations();//placeholder for calculations
    //adjust the louvers
    adjustLouvers();

  }
}
